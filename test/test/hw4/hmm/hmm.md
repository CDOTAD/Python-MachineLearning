

```python
import pandas
```


```python
train4G=pandas.read_csv('4G/final_4g_tr.csv')
```


```python
test4G=pandas.read_csv('4G/final_4g_te.csv')
```


```python
columns=dict()
```


```python
colunms_list=list(train4G.columns)
```


```python
for column in colunms_list:
    
    columns[column]=colunms_list.index(column)
```


```python
rscp_list=[columns['RSCP_'+str(i)] for i in range(1,7)]
```


```python
ecno_list=[columns['EcNo_'+str(i)]for i in range(1,7)]
```


```python
group_divide_grid=dict()
```


```python
import numpy as np
```


```python
for i in range(len(train4G.Grid_ID)):
    if train4G.Grid_ID[i] not in group_divide_grid.keys():
        
        group_divide_grid[train4G.Grid_ID[i]]=[]
    
    record = list(train4G.ix[i])
    
    re = [record[rscp_list[0]] - record[ecno_list[0]]] 
        
    group_divide_grid[train4G.Grid_ID[i]].append(re)
    
```


```python
grid_coordinate=dict()

for i in range(len(train4G.Grid_ID)):
    
    grid_coordinate[train4G.Grid_ID[i]]=[train4G.Grid_center_x[i],train4G.Grid_center_y[i]]



```


```python
base_station_list=[]
for i in range(len(train4G.Grid_ID)):
    
    if [train4G.SRNCID[i],train4G.BestCellID[i]] not in base_station_list:
        
        base_station_list.append([train4G.SRNCID[i],train4G.BestCellID[i]])
        
```


```python
len(base_station_list)
```




    127




```python
test_divde=dict()
for i in range(len(train4G.Grid_ID)):
    
    if train4G.Grid_ID[i] not in test_divde.keys():
        
        test_divde[train4G.Grid_ID[i]]=dict()
    
    index = base_station_list.index([train4G.SRNCID[i],train4G.BestCellID[i]])
    
    if index not in test_divde[train4G.Grid_ID[i]].keys():
        
        test_divde[train4G.Grid_ID[i]][index]=[]
    
    record = list(train4G.ix[i])
    
    re = record[ecno_list[0]]-record[rscp_list[0]]
   
    
    test_divde[train4G.Grid_ID[i]][index].append(re)
```


```python
test_divde[0]
```




    {33: [66.379999999999995, 66.379999999999995, 66.379999999999995],
     36: [68.75,
      68.0,
      69.129999999999995,
      70.25,
      69.0,
      69.5,
      68.75,
      68.0,
      69.129999999999995,
      70.25,
      69.0,
      69.5,
      68.75,
      68.0,
      69.129999999999995,
      70.25,
      69.0,
      69.5,
      69.620000000000005,
      69.0,
      67.370000000000005]}




```python
rssi_list=[]

for key,records in test_divde.items():
    
    rssi_list.extend(records)
```


```python
rssi_list.sort()
```


```python
max(rssi_list)
```




    979.0




```python
rssi_list[int(len(rssi_list)/2)]
```




    69.75




```python
np.mean(rssi_list)
```




    71.125026501766783




```python
count = 0

ave=np.mean(rssi_list)

for item in rssi_list:
    
    if item>ave:
        
        count+=1
```


```python
count
```




    8545




```python
len(rssi_list)
```




    19244




```python
count/float(len(rssi_list))
```




    0.4440345042610684




```python
rssi_list[int(0.8*len(rssi_list))]
```




    79.25




```python
min(rssi_list)
```




    0.0




```python
np.unique(rssi_list)
```




    array([   0.  ,   42.75,   45.12,   45.38,   45.5 ,   45.63,   45.75,
             46.25,   46.37,   46.62,   47.25,   47.37,   47.38,   47.5 ,
             47.62,   47.75,   48.  ,   48.25,   48.5 ,   48.62,   48.63,
             48.75,   48.87,   49.  ,   49.25,   49.38,   49.62,   49.63,
             49.75,   49.87,   49.88,   50.  ,   50.  ,   50.13,   50.25,
             50.37,   50.5 ,   50.63,   50.63,   50.75,   50.87,   51.  ,
             51.12,   51.25,   51.25,   51.37,   51.38,   51.38,   51.5 ,
             51.62,   51.63,   51.75,   51.87,   51.88,   51.88,   52.  ,
             52.  ,   52.12,   52.12,   52.13,   52.25,   52.25,   52.37,
             52.38,   52.38,   52.5 ,   52.5 ,   52.62,   52.63,   52.63,
             52.75,   52.75,   52.87,   52.88,   53.  ,   53.  ,   53.12,
             53.12,   53.13,   53.13,   53.25,   53.25,   53.37,   53.37,
             53.38,   53.5 ,   53.5 ,   53.62,   53.62,   53.63,   53.75,
             53.75,   53.87,   53.88,   54.  ,   54.  ,   54.12,   54.12,
             54.13,   54.25,   54.25,   54.37,   54.38,   54.5 ,   54.5 ,
             54.62,   54.63,   54.75,   54.75,   54.87,   54.87,   54.88,
             55.  ,   55.  ,   55.12,   55.12,   55.13,   55.25,   55.25,
             55.37,   55.38,   55.5 ,   55.5 ,   55.62,   55.63,   55.75,
             55.75,   55.87,   55.88,   56.  ,   56.  ,   56.12,   56.12,
             56.13,   56.25,   56.25,   56.37,   56.37,   56.38,   56.5 ,
             56.5 ,   56.62,   56.62,   56.63,   56.75,   56.75,   56.87,
             56.87,   56.88,   57.  ,   57.  ,   57.12,   57.12,   57.13,
             57.25,   57.25,   57.37,   57.37,   57.38,   57.5 ,   57.5 ,
             57.62,   57.62,   57.63,   57.75,   57.75,   57.87,   57.87,
             57.88,   58.  ,   58.  ,   58.12,   58.12,   58.13,   58.25,
             58.25,   58.37,   58.37,   58.38,   58.5 ,   58.5 ,   58.62,
             58.62,   58.63,   58.75,   58.75,   58.87,   58.87,   58.88,
             59.  ,   59.  ,   59.12,   59.12,   59.13,   59.25,   59.25,
             59.37,   59.37,   59.38,   59.5 ,   59.5 ,   59.62,   59.62,
             59.63,   59.75,   59.75,   59.87,   59.87,   59.88,   60.  ,
             60.  ,   60.12,   60.12,   60.13,   60.25,   60.25,   60.37,
             60.37,   60.38,   60.5 ,   60.5 ,   60.62,   60.62,   60.63,
             60.75,   60.75,   60.87,   60.87,   60.88,   61.  ,   61.  ,
             61.12,   61.12,   61.13,   61.25,   61.25,   61.37,   61.37,
             61.38,   61.5 ,   61.5 ,   61.62,   61.62,   61.63,   61.75,
             61.75,   61.87,   61.87,   61.88,   62.  ,   62.  ,   62.12,
             62.12,   62.13,   62.25,   62.25,   62.37,   62.37,   62.38,
             62.5 ,   62.5 ,   62.62,   62.62,   62.63,   62.75,   62.75,
             62.87,   62.87,   62.88,   63.  ,   63.  ,   63.12,   63.12,
             63.13,   63.25,   63.25,   63.37,   63.37,   63.38,   63.5 ,
             63.5 ,   63.62,   63.62,   63.63,   63.75,   63.75,   63.87,
             63.87,   63.88,   64.  ,   64.  ,   64.12,   64.13,   64.25,
             64.37,   64.38,   64.5 ,   64.62,   64.63,   64.75,   64.87,
             64.88,   65.  ,   65.12,   65.13,   65.25,   65.37,   65.38,
             65.5 ,   65.62,   65.63,   65.75,   65.87,   65.88,   66.  ,
             66.12,   66.13,   66.25,   66.37,   66.38,   66.5 ,   66.62,
             66.63,   66.75,   66.87,   66.88,   67.  ,   67.12,   67.13,
             67.25,   67.37,   67.38,   67.5 ,   67.62,   67.63,   67.75,
             67.87,   67.88,   68.  ,   68.12,   68.13,   68.25,   68.37,
             68.38,   68.5 ,   68.62,   68.63,   68.75,   68.87,   68.88,
             69.  ,   69.12,   69.13,   69.25,   69.37,   69.38,   69.5 ,
             69.62,   69.63,   69.75,   69.87,   69.88,   70.  ,   70.12,
             70.13,   70.25,   70.37,   70.38,   70.5 ,   70.62,   70.63,
             70.75,   70.87,   70.88,   71.  ,   71.12,   71.13,   71.25,
             71.37,   71.38,   71.5 ,   71.62,   71.63,   71.75,   71.87,
             71.88,   72.  ,   72.12,   72.13,   72.25,   72.37,   72.38,
             72.5 ,   72.62,   72.63,   72.75,   72.87,   72.88,   73.  ,
             73.12,   73.13,   73.25,   73.37,   73.38,   73.5 ,   73.62,
             73.63,   73.75,   73.87,   73.88,   74.  ,   74.12,   74.13,
             74.25,   74.37,   74.38,   74.5 ,   74.62,   74.63,   74.75,
             74.87,   74.88,   75.  ,   75.12,   75.13,   75.25,   75.37,
             75.38,   75.5 ,   75.62,   75.63,   75.75,   75.87,   75.88,
             76.  ,   76.12,   76.13,   76.25,   76.37,   76.38,   76.5 ,
             76.62,   76.63,   76.75,   76.87,   76.88,   77.  ,   77.12,
             77.13,   77.25,   77.37,   77.38,   77.5 ,   77.62,   77.63,
             77.75,   77.87,   77.88,   78.  ,   78.12,   78.13,   78.25,
             78.37,   78.38,   78.5 ,   78.62,   78.63,   78.75,   78.87,
             78.88,   79.  ,   79.12,   79.13,   79.25,   79.37,   79.38,
             79.5 ,   79.62,   79.63,   79.75,   79.87,   79.88,   80.  ,
             80.12,   80.13,   80.25,   80.37,   80.38,   80.5 ,   80.62,
             80.63,   80.75,   80.87,   80.88,   81.  ,   81.12,   81.13,
             81.25,   81.37,   81.38,   81.5 ,   81.62,   81.63,   81.75,
             81.87,   81.88,   82.  ,   82.12,   82.13,   82.25,   82.37,
             82.38,   82.5 ,   82.62,   82.63,   82.75,   82.87,   82.88,
             83.  ,   83.12,   83.13,   83.25,   83.37,   83.38,   83.5 ,
             83.62,   83.63,   83.75,   83.87,   83.88,   84.  ,   84.12,
             84.13,   84.25,   84.37,   84.38,   84.5 ,   84.62,   84.63,
             84.75,   84.87,   84.88,   85.  ,   85.12,   85.13,   85.25,
             85.37,   85.38,   85.5 ,   85.62,   85.63,   85.75,   85.87,
             85.88,   86.  ,   86.12,   86.13,   86.25,   86.37,   86.38,
             86.5 ,   86.62,   86.63,   86.75,   86.87,   86.88,   87.  ,
             87.12,   87.13,   87.25,   87.37,   87.38,   87.5 ,   87.62,
             87.63,   87.75,   87.87,   87.88,   88.  ,   88.12,   88.13,
             88.25,   88.37,   88.38,   88.5 ,   88.62,   88.63,   88.75,
             88.87,   88.88,   89.  ,   89.12,   89.13,   89.25,   89.37,
             89.38,   89.5 ,   89.62,   89.63,   89.75,   89.87,   89.88,
             90.  ,   90.12,   90.13,   90.25,   90.37,   90.38,   90.5 ,
             90.62,   90.63,   90.75,   90.88,   91.  ,   91.12,   91.13,
             91.25,   91.38,   91.5 ,   91.62,   91.63,   91.75,   91.87,
             91.88,   92.  ,   92.12,   92.13,   92.25,   92.37,   92.38,
             92.62,   92.75,   92.88,   93.  ,   93.12,   93.13,   93.25,
             93.38,   93.75,  108.25,  108.5 ,  109.5 ,  110.5 ,  110.88,
            111.  ,  111.12,  979.  ])




```python
min_rssi=42.75
max_rssi=rssi_list[int(0.8*len(rssi_list))]

for key,records in test_divde.items():
        
    for cellID,record in records.items():
        
        rssi_scale=[]
        
        for item in record:
            rssi = round( ((item - min_rssi) / (max_rssi - min_rssi) * 31) ) 

            if rssi<0:

                rssi = 0

            if rssi>31:

                rssi = 31

            rssi_scale.append(rssi)

        test_divde[key][cellID]=rssi_scale
```


```python
for key,records in test_divde.items():
    
    for cellID,record in records.items():
        print np.unique(record)
```

    [ 20.]
    [ 21.  22.  23.]
    [ 31.]
    [ 28.]
    [ 13.  14.  15.  16.  17.  18.  19.  20.]
    [ 29.  31.]
    [31]
    [  7.  12.  15.  21.]
    [ 19.  20.  22.  23.  24.  25.  26.  27.  28.  30.  31.]
    [ 26.]
    [ 16.  18.  22.]
    [ 19.  20.  23.  25.  26.  27.  28.  29.  30.  31.]
    [ 20.  22.  24.]
    [ 24.  26.]
    [ 16.  19.  23.]
    [ 18.  21.  25.  26.  27.  28.  29.  30.]
    [ 18.  19.  20.]
    [ 13.  20.  21.]
    [ 23.  24.  25.  30.]
    [ 26.]
    [ 18.  24.  25.  28.]
    [ 25.]
    [ 18.  23.]
    [ 17.  18.  19.  23.  24.  25.  26.  27.]
    [ 22.  23.]
    [ 20.  21.  22.  23.  24.  25.  26.  27.  28.  29.]
    [ 24.]
    [ 25.  26.  28.  29.  30.  31.]
    [ 22.]
    [ 18.  22.  23.]
    [ 17.  18.  19.  20.]
    [ 26.]
    [ 23.  25.]
    [ 14.  17.  18.  20.  21.  22.  23.  24.  25.  26.  27.  28.]
    [ 14.]
    [  7.   9.  10.  12.  13.]
    [ 31.]
    [ 27.  28.  31.]
    [ 13.  16.  21.]
    [ 18.]
    [ 12.  13.  14.  15.  16.  20.  21.]
    [ 22.  26.  28.]
    [ 27.  29.]
    [ 13.  18.  19.  20.  22.  23.  25.]
    [ 24.  26.  28.]
    [ 15.  17.  18.  20.  21.]
    [ 17.  20.  21.  22.]
    [ 20.]
    [ 27.  28.  29.  30.  31.]
    [31]
    [ 5.  6.  7.]
    [ 18.  20.  22.  24.  26.  28.]
    [31]
    [ 27.]
    [31]
    [31]
    [ 30.]
    [ 22.  25.  26.]
    [ 23.  26.]
    [ 18.  22.]
    [ 16.  18.]
    [ 17.  18.  19.  20.  21.  24.  25.]
    [ 18.  20.  21.  22.  23.  25.  28.  29.]
    [  8.  16.  17.  19.  20.  21.  22.  23.]
    [ 17.  19.  20.  21.]
    [31]
    [ 27.]
    [ 22.]
    [ 23.  25.  26.  28.]
    [ 11.  13.  14.  18.  20.  21.  22.  23.  24.  26.  31.]
    [ 20.  21.  23.]
    [ 30.  31.]
    [ 25.  28.  31.]
    [ 30.]
    [ 31.]
    [ 14.  18.  19.  20.]
    [ 11.  13.  14.  15.  16.  17.]
    [ 22.  26.  29.]
    [31]
    [ 12.  13.  15.  16.]
    [ 28.  29.  30.  31.]
    [  9.  10.  11.  15.  16.  17.  18.  20.]
    [ 24.  26.]
    [ 31.]
    [ 21.  22.]
    [ 19.]
    [  7.  11.  13.  14.  16.]
    [ 23.  24.  26.]
    [ 20.]
    [ 14.  15.  16.  21.]
    [ 23.  24.  25.  26.  27.  28.  29.]
    [ 16.  21.  22.  25.]
    [ 20.  21.  24.  25.  28.  30.  31.]
    [ 19.]
    [ 17.]
    [ 29.]
    [ 29.]
    [ 24.]
    [  4.   6.   8.   9.  10.  11.  12.  13.  14.  16.  18.  20.  22.  24.  26.]
    [  8.   9.  12.  16.]
    [ 19.  20.  22.  23.  24.  25.  26.  27.  28.  29.]
    [ 19.]
    [ 18.  19.  20.  22.  23.  24.  25.  26.  27.  28.  29.]
    [ 19.  20.  21.  22.  24.  26.  27.]
    [  8.  14.  18.  20.  21.  23.]
    [  6.   7.   8.  15.  16.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.
      28.  29.]
    [ 15.  16.  17.  20.  24.]
    [ 27.]
    [ 21.]
    [ 24.  25.  26.  27.  28.]
    [ 17.  18.  20.  24.  27.]
    [ 17.  18.  19.  20.  22.  23.  25.]
    [ 25.  27.  30.]
    [ 23.  24.  25.  26.  27.  28.  29.  30.  31.]
    [ 11.  16.]
    [ 14.  15.  16.]
    [ 24.]
    [31]
    [ 26.  28.  30.]
    [ 22.  29.]
    [ 31.]
    [ 29.  30.  31.]
    [31]
    [ 31.]
    [31]
    [  7.  10.  11.  12.  14.  15.  16.]
    [ 14.  16.]
    [ 19.  20.  22.  28.  30.]
    [ 18.  20.]
    [31]
    [ 26.  30.  31.]
    [31]
    [ 24.]
    [ 22.]
    [  3.   5.   6.   9.  12.  16.]
    [31]
    [31]
    [ 26.  30.]
    [ 21.  25.  26.  27.  28.]
    [ 28.]
    [31]
    [0]
    [ 23.  25.  26.  27.  28.  29.  30.  31.]
    [ 17.  18.  19.]
    [ 22.  23.]
    [ 11.  13.  14.  18.  19.  20.  21.  22.  23.]
    [31]
    [ 17.  18.  19.]
    [  3.  13.  17.]
    [ 14.]
    [ 18.  21.  24.]
    [ 21.  23.  24.  25.  27.]
    [ 16.  17.  18.  19.  20.  24.  25.  26.]
    [ 13.]
    [ 24.  28.  30.]
    [ 23.]
    [ 24.  27.]
    [ 13.  14.  17.  20.  21.  23.]
    [ 23.]
    [  6.   8.  12.]
    [ 19.  22.  24.]
    [ 23.  25.]
    [ 20.]
    [ 3.  6.  9.]
    [ 27.  29.  30.  31.]
    [31]
    [31]
    [  0.   2.  11.  18.]
    [ 18.  20.  21.  22.  24.]
    [ 21.  22.]
    [ 19.]
    [ 20.  21.  22.]
    [  9.  10.  11.  12.  14.  15.]
    [ 11.  13.]
    [ 30.  31.]
    [ 15.  16.  19.  20.  21.  22.  24.  26.]
    [ 13.]
    [ 26.  27.]
    [ 18.  21.  22.  24.  25.]
    [ 12.  17.]
    [ 16.  20.  23.  24.]
    [ 20.  22.]
    [ 22.  23.  24.]
    [ 12.  15.  17.  18.  19.  20.  21.  22.  23.  24.  25.]
    [ 16.  17.  18.  19.]
    [ 13.  18.  19.  20.  21.]
    [ 21.  23.  24.]
    [ 22.]
    [ 25.  27.  30.]
    [ 16.  17.  18.  19.  20.  22.]
    [ 22.  24.]
    [ 27.  30.  31.]
    [31]
    [ 10.  14.  16.]
    [ 20.  21.]
    [ 13.  14.  16.  17.  18.  19.  20.  21.]
    [ 17.  20.  21.  26.]
    [ 20.  22.  24.  25.  26.]
    [ 31.]
    [ 30.  31.]
    [ 22.  23.]
    [ 25.]
    [ 30.]
    [ 25.  27.]
    [31]
    [ 23.  26.  29.  30.  31.]
    [  9.  11.  13.  14.  15.  17.  18.  19.  20.  22.]
    [  9.  10.  11.  12.  13.  14.  15.  16.  17.  18.]
    [ 15.  16.  17.]
    [ 27.]
    [ 15.  16.  17.  20.]
    [31]
    [31]
    [ 21.  22.  25.  26.]
    [31]
    [ 11.  13.  15.]
    [  9.  13.]
    [  5.   9.  10.  12.  13.]
    [  2.   4.   6.  10.  15.]
    [ 10.  14.]
    [ 25.  26.]
    [ 12.]
    [ 18.  19.  20.]
    [ 17.  19.  20.  21.  22.  23.]
    [ 15.  17.  18.  20.  21.]
    [ 14.]
    [ 22.]
    [ 16.  17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.  28.]
    [ 25.]
    [ 11.  13.  16.  17.  18.  19.  21.  24.  27.]
    [ 13.  17.  22.  23.  24.]
    [ 15.  16.  17.  18.]
    [ 21.  23.]
    [ 27.  28.  29.]
    [ 28.]
    [ 26.  27.]
    [  9.  12.  14.  15.  18.]
    [ 28.  29.  31.]
    [ 22.  23.  24.  25.  26.  27.  28.  29.]
    [ 22.  23.  24.  25.  26.  28.  29.  30.]
    [ 24.]
    [ 27.  28.  29.  31.]
    [ 20.  21.  22.  23.  24.  25.  26.  27.  28.  29.  31.]
    [ 28.  30.]
    [31]
    [31]
    [ 17.  18.  19.  20.  21.  22.  23.  25.  26.]
    [ 17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.  28.]
    [ 27.]
    [ 24.  26.]
    [ 24.  25.  28.]
    [ 28.]
    [31]
    [ 16.  17.  18.  19.  20.  21.  22.  23.]
    [ 13.  14.  16.  17.  20.]
    [ 11.]
    [ 13.  17.  18.  19.]
    [ 25.]
    [ 21.]
    [ 26.  27.  28.  29.  30.  31.]
    [ 25.  27.]
    [ 20.  22.  23.  25.  26.  27.]
    [ 23.  28.]
    [ 12.  13.  14.  15.  16.  17.  18.  19.  20.  21.]
    [ 8.]
    [ 26.  27.  28.]
    [ 13.  14.  15.  17.]
    [ 23.  24.  26.  27.  28.  29.  30.  31.]
    [  8.  13.]
    [ 24.  31.]
    [ 21.  22.  24.]
    [ 24.  25.  26.  27.]
    [ 25.  28.  29.  30.  31.]
    [ 12.]
    [ 29.  31.]
    [31]
    [ 26.]
    [ 23.  24.  27.]
    [31]
    [ 31.]
    [31]
    [31]
    [31]
    [ 24.]
    [ 21.  27.]
    [ 21.  27.]
    [ 18.  23.]
    [ 15.  16.  17.  18.  19.]
    [ 13.  14.  16.  17.  18.  19.  20.  21.  22.  23.]
    [ 25.  27.  28.  29.  31.]
    [  8.   9.  10.  11.  13.  14.  15.  16.  17.  18.  19.  20.  22.  23.]
    [ 13.  14.  16.]
    [ 15.  23.]
    [ 16.  18.]
    [ 15.  23.]
    [ 14.  15.  16.  17.  19.  21.  22.  23.]
    [  8.  10.  12.]
    [  6.  10.  11.  12.  13.  20.  21.]
    [ 12.  13.  15.]
    [ 23.  31.]
    [31]
    [ 14.]
    [31]
    [ 29.  31.]
    [31]
    [ 13.  18.  20.  22.  23.  24.]
    [  9.  11.  12.  14.  15.]
    [ 24.  25.  27.  28.  29.  30.]
    [  9.  14.  15.  19.]
    [ 13.  16.  17.  18.  19.  21.  24.  27.]
    [ 12.  15.  18.  20.  21.]
    [ 24.  26.  29.  30.  31.]
    [ 19.  21.  24.  27.]
    [31]
    [ 29.  31.]
    [ 12.  13.]
    [ 14.  16.  17.  18.  19.]
    [ 23.  26.  27.]
    [ 21.  23.  24.  28.]
    [ 27.]
    [ 21.  25.]
    [ 19.]
    [ 23.  24.  26.  28.]
    [ 17.  18.  19.  20.  21.  22.  23.  24.]
    [ 19.  20.  21.  22.]
    [ 21.]
    [  7.  15.  16.  19.]
    [ 12.  13.  15.  16.]
    [ 25.  26.]
    [ 11.  16.]
    [ 15.  17.]
    [ 11.  12.  14.  15.  16.  18.  19.  21.  22.]
    [ 15.  16.  17.  18.  19.  20.  21.  22.  23.]
    [ 16.  17.  18.  19.  20.  21.]
    [ 12.  15.  17.]
    [ 10.  11.  12.  13.  16.  17.  19.]
    [ 15.  17.  19.  23.]
    [ 15.  18.  19.  20.  21.  22.  23.  24.  26.  27.]
    [ 25.  28.]
    [ 23.  25.  27.]
    [ 13.  17.  18.]
    [ 16.  20.]
    [ 17.  20.  23.]
    [ 19.  20.  21.]
    [ 10.  11.  12.  14.  15.  17.  18.]
    [ 30.]
    [ 29.  31.]
    [ 20.]
    [ 15.  17.]
    [ 18.  19.  23.  24.  25.  26.]
    [ 21.  22.  25.]
    [ 31.]
    [ 25.  28.  29.  30.  31.]
    [ 28.]
    [ 22.]
    [ 10.  15.  16.  17.  18.  19.  20.  21.  22.  23.]
    [31]
    [31]
    [ 20.  21.  22.  23.  24.  25.  26.  27.]
    [  9.  10.  12.  14.  15.  16.]
    [ 24.  25.  27.  28.]
    [ 19.  20.  22.  23.  24.]
    [31]
    [31]
    [ 23.  24.  26.  30.]
    [ 24.  27.]
    [ 17.  27.]
    [ 27.]
    [  9.  10.  11.  12.  13.  14.  15.  16.  17.  18.  19.  22.  23.  24.]
    [ 14.  16.]
    [ 25.  30.  31.]
    [ 18.  19.  21.  26.  28.  29.]
    [ 12.  14.]
    [ 16.  17.  20.  24.]
    [31]
    [ 11.  12.  13.  14.  15.  16.  17.  18.  19.  21.]
    [ 13.  14.  15.]
    [ 21.  22.  25.]
    [ 19.]
    [31]
    [ 15.  16.  17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.]
    [ 19.]
    [ 21.]
    [ 20.]
    [ 11.  12.  13.  15.  16.]
    [ 11.]
    [  9.  10.  11.  13.]
    [ 31.]
    [ 31.]
    [31]
    [ 29.  31.]
    [  8.   9.  10.  11.  12.  13.  14.  15.  16.  17.  18.  19.  20.  21.  22.
      24.]
    [  9.  12.  13.  14.  15.  16.  17.  18.  21.]
    [  4.   6.   9.  12.  16.  19.  20.  21.  22.]
    [ 23.  25.  28.  29.  30.  31.]
    [ 19.]
    [ 23.  28.]
    [31]
    [ 11.  12.  13.  14.  15.]
    [31]
    [ 23.  24.  25.  27.  28.  29.  30.  31.]
    [31]
    [31]
    [ 27.  28.]
    [ 21.  22.  24.]
    [ 25.  27.  28.  29.  30.]
    [ 14.  17.  19.  20.  21.  26.]
    [ 12.  13.  14.  15.  16.  17.  18.  19.  20.  21.  22.  23.  26.  27.]
    [ 17.  18.  19.  23.  24.  26.  28.]
    [ 31.]
    [ 16.  17.  18.  19.  20.]
    [ 22.  27.]
    [ 17.  18.  19.  20.  22.]
    [ 22.  28.]
    [ 23.  24.  27.]
    [ 25.  27.  29.  30.  31.]
    [ 22.  25.  26.  27.  28.  30.]
    [ 10.]
    [ 17.  18.]
    [31]
    [ 25.  29.  31.]
    [31]
    [ 19.  26.  29.]
    [ 13.  17.]
    [ 10.]
    [ 14.  16.]
    [ 26.  29.  30.  31.]
    [ 26.  29.  30.  31.]
    [ 23.  24.  25.  26.  27.]
    [ 17.  21.  24.]
    [31]
    [ 30.  31.]
    [ 13.  14.  15.  16.  17.  18.  19.  20.  23.]
    [31]
    [31]
    [31]
    [31]
    [31]
    [  9.  12.  14.  15.  16.  17.  18.  19.  21.  25.  28.]
    [  7.  10.  11.  12.  17.  18.  20.]
    [  9.  10.  11.  13.  14.  15.  16.  17.  18.  20.  23.]
    [ 16.  17.  18.  19.  20.]
    [ 12.  13.  14.  15.  16.  18.]
    [ 17.  18.  19.  22.  23.  25.  26.  27.  28.  29.]
    [ 28.]
    [ 21.  22.]
    [ 21.  22.  26.  27.  28.]
    [ 20.  21.  24.]
    [ 15.  16.]
    [ 13.  17.  21.  22.]
    [ 20.  21.]
    [ 22.  25.  26.]
    [  3.   8.  10.  12.  14.  16.  20.]
    [ 18.  23.]
    [ 23.]
    [ 24.]
    [ 26.  28.  29.]
    [ 12.]
    [ 19.  21.  22.  23.  24.]
    [ 12.  13.]
    [ 24.  28.  30.  31.]
    [ 13.]
    [ 23.]
    [31]
    [31]
    [31]
    [ 28.  31.]
    [ 26.  30.]
    [ 29.  30.  31.]
    [ 16.]
    [ 19.]
    [ 17.  18.  22.]
    [  9.  12.  13.  15.  16.  17.  18.  20.  21.  22.]
    [ 15.  18.  24.  27.  29.  31.]
    [ 17.  19.  27.  31.]
    [ 28.]
    [ 17.]
    [ 18.  19.  20.]
    [ 31.]
    [ 25.]
    [ 23.  24.  27.]
    [ 13.  16.  18.]
    [ 13.  14.  15.  19.  20.  21.  22.  23.  24.  25.]
    [ 22.  24.  25.  28.  29.]
    [ 27.]
    [ 19.  21.]
    [ 11.  13.  18.]
    [ 21.  25.  26.  31.]
    [ 26.  29.  31.]
    [ 30.  31.]
    [ 18.]
    [ 19.  22.]
    [ 14.  19.  20.  21.  22.]
    [ 11.  12.  13.  14.]
    [31]
    [ 16.  17.  19.  21.  22.  23.]
    [ 12.  14.  15.  17.]
    [31]
    [31]
    [ 18.  19.  21.  31.]
    [31]
    [ 23.  25.  26.  28.  29.  31.]
    [ 30.]
    [31]
    [ 14.  16.  18.  20.]
    [ 21.  22.  23.]
    [ 27.]
    [ 25.  28.]
    [ 19.]
    [31]
    [ 27.  30.  31.]
    [31]
    [31]
    [31]
    [31]
    [ 17.  19.  22.]
    [ 25.  27.  30.  31.]
    [ 19.  20.  21.  22.  23.  24.  25.  26.  27.  28.  31.]
    [ 17.  20.  21.  22.  23.]
    [ 21.  23.  26.]
    [ 24.  31.]
    [ 7.  8.  9.]
    [ 24.]
    [ 18.  20.  21.  22.  24.]
    [ 14.  20.]
    [ 14.  19.  20.  21.  22.  23.  24.]
    [ 12.  14.  16.]
    [ 23.  24.  26.]
    [ 10.  14.  18.]
    [ 19.  20.  26.  27.]
    [ 13.  14.  17.  18.]
    [  4.   5.   8.  13.  14.]
    [ 27.]
    [ 26.  27.]
    [ 19.  22.  27.]
    [  6.   8.  11.  15.  16.  20.]
    [  8.   9.  10.  12.  16.  19.]
    [  8.  11.  13.]
    [ 11.  12.  13.  14.  15.  17.]
    [  9.  11.  12.]
    [ 13.]
    [ 12.  14.  16.  18.  22.  23.]
    [ 28.]
    [ 16.  18.  22.]
    [ 14.]
    [ 20.]
    [ 21.  22.  23.  24.  25.  26.  27.  28.  30.  31.]
    [ 14.  16.  17.  18.  19.  20.  21.]
    [ 18.  22.  24.  30.  31.]
    [ 20.]
    [ 16.  18.  21.  23.  24.  25.  27.]
    [31]
    [31]
    [ 22.]
    [ 20.  21.  24.]
    [ 28.  30.]
    [ 22.]
    [31]
    [ 10.  11.  12.  13.  14.  15.  16.  17.  18.  19.]
    [ 20.  22.  23.]
    [31]
    [ 28.  31.]
    [ 25.]
    [ 24.  25.]
    [ 22.  26.  27.]
    [ 18.  19.  20.  21.  22.  23.]
    [ 16.  18.]
    [ 19.  20.  21.  22.  23.  24.  26.  27.]
    [ 18.  19.]
    [ 25.]
    [31]
    [ 27.  31.]
    [ 11.]
    [ 26.]
    [31]
    [ 30.]
    [ 15.  16.  18.]
    [ 11.  12.  16.  17.  18.  22.]
    [ 15.  16.  17.  18.  19.  20.  21.]
    [ 10.  15.]
    [ 12.  18.  23.  24.  25.]
    [ 13.  18.  20.  21.  23.]
    [  8.   9.  11.]
    [ 12.  13.  15.  16.  18.  19.]
    [ 29.]
    [ 24.  25.  27.]
    [ 20.  21.  22.]
    [ 23.]
    [ 18.  19.  21.  23.]
    [ 16.  18.  19.  20.]
    [ 17.]
    [ 24.  28.  29.  31.]
    [ 30.  31.]
    [31]
    [ 21.  23.]
    [ 18.  22.  23.  24.  25.  26.  27.]
    [ 25.  29.  30.  31.]
    [ 11.  12.  13.  14.  15.  16.  17.  18.  20.  22.]
    [ 12.  15.]
    [ 13.  14.  15.  16.  17.  18.  20.  21.]
    [ 21.  23.  25.]
    [ 15.]
    [ 16.  17.  21.  26.  27.]
    [ 14.  18.  21.]
    [ 16.  17.  19.]
    [  7.   8.   9.  13.  21.]
    [ 19.  20.  21.  22.]
    [ 17.  18.  19.  20.  22.  23.]
    [ 20.  21.  22.  24.  25.  26.]
    [ 26.  27.  28.  29.  30.  31.]
    [ 20.  21.  22.  23.  24.  25.  26.  28.]
    [ 11.  16.  17.  19.  20.  22.  23.  24.]
    [ 18.  19.  25.  26.  28.]
    [ 28.  29.]
    [ 22.  23.  24.  25.  26.  27.  28.  29.  30.]
    [ 19.]
    [ 13.  14.  16.  17.  18.]
    [ 24.  25.  26.  27.  29.]
    [ 22.  26.]
    [ 25.  27.]
    [ 24.  26.  27.]
    [ 15.  16.  18.  20.  21.  22.  24.]
    [ 28.  30.  31.]
    [31]
    [ 31.]
    [31]
    [ 26.]
    [31]
    [ 15.  16.  17.  18.  19.]
    [ 29.]
    [ 18.]
    [ 21.  22.]
    [ 24.]
    [ 21.  22.  23.  25.]
    [ 12.  20.  21.]
    [ 15.  16.  22.]
    [ 17.  18.  19.  20.  21.  24.]
    [31]
    [31]
    [ 13.  14.  16.  17.  18.  19.  21.  22.  23.  24.  25.  27.  28.  29.]
    [31]
    [ 14.  16.  17.  18.  20.  23.]
    [ 12.  13.  16.  17.  20.  22.]
    [ 18.  22.  23.]
    [31]
    [ 29.  31.]
    [  9.  14.  15.  16.  17.  18.  19.  20.  21.]
    [ 20.  21.  22.  23.  24.  26.  27.  30.  31.]
    [ 25.]
    [ 22.]
    [ 24.]
    [ 16.]
    [ 17.  18.  19.  20.  21.  23.]
    [ 14.  18.  19.  20.  23.]
    [ 24.]
    [ 20.  22.  23.  24.  25.]
    [ 12.  14.  15.  16.  19.  20.]
    [ 15.  16.  18.  19.  20.  21.  22.  23.]
    [ 25.  27.]
    [ 28.]
    [ 25.  26.  27.]
    [ 31.]
    [31]
    [ 18.  20.  23.]
    [ 14.  16.  19.  20.  21.  23.  24.  25.  26.  27.  28.  29.  30.  31.]
    [ 14.]
    [ 16.  17.  18.  23.]
    [ 20.  21.  23.]
    [ 30.]
    [ 28.  31.]
    [ 12.  20.  24.  25.]
    [ 10.  11.  12.  14.  17.  19.  20.  21.  23.  24.  27.  28.  30.  31.]
    [ 14.  21.  22.  25.  27.]
    [ 19.  20.  21.  22.  23.  25.  26.]
    [ 13.  14.  15.  16.  17.  18.  21.]
    [  9.  10.  12.  13.  14.  16.  17.]
    [ 13.  14.  15.]
    [ 13.  17.  18.  19.  20.  21.  22.  23.  25.]
    [ 23.  26.]
    [ 19.  20.  21.  22.  23.  24.  26.  27.]
    [ 27.  28.  30.  31.]
    [ 19.  24.  25.  26.  29.  30.]
    [ 13.]
    [ 20.  21.  22.  23.  24.  25.  27.]
    [ 19.  20.  21.  22.  23.  24.  25.  30.]
    [ 19.  20.  21.  22.  23.  27.  28.]
    [ 16.  20.]
    [31]
    [31]
    [ 14.  19.  20.  21.]
    [ 23.]
    [  6.  12.  14.  15.]
    [ 27.  31.]
    [ 17.  19.]
    [ 20.  23.  29.  30.]
    [ 19.  20.]
    [ 27.  28.  29.  30.  31.]
    [ 27.  28.]
    [ 5.  7.  8.  9.]
    [31]
    [ 23.  26.  27.  28.  29.  30.]
    [ 22.  23.  25.  26.  27.  28.  29.  30.]
    [ 28.  29.  30.  31.]
    [31]
    [  7.   8.  13.  14.]
    [ 14.  15.]
    [ 28.  29.  30.  31.]
    [ 23.  27.]
    [ 11.  13.  14.  15.  16.  17.  18.  19.  20.]
    [ 16.  17.  18.  19.  20.  21.]
    [31]
    [31]
    [ 21.  22.  23.  25.  26.  27.]
    [ 24.  26.  27.  28.  29.]
    [ 15.  16.  18.  20.]
    [ 14.  15.]
    [ 21.  23.]
    [ 24.  26.  27.]
    [  4.   6.  12.  14.  16.  18.]
    [ 16.  17.  18.  19.  20.]
    [  8.  10.  13.  15.]
    [ 7.]
    [ 14.  16.  17.  18.  20.]
    [ 14.  16.  17.  18.  19.  20.  23.]
    [ 15.  16.  18.  19.  23.  25.]
    [ 11.  16.]
    [  8.   9.  11.  12.  13.  14.  15.  18.]
    [  8.  12.  14.]
    [ 17.]
    [ 18.]
    [ 10.  19.]
    [ 19.  24.  26.  28.  29.  30.  31.]
    [ 30.  31.]
    [ 26.  27.]
    [ 13.  23.]
    [ 29.  30.  31.]
    [31]
    [ 28.  31.]
    [31]
    [ 17.]
    [ 22.]
    [ 15.  20.  24.]
    [ 27.  30.  31.]
    [ 19.  20.  21.  22.  23.  25.]
    [ 28.]
    [ 30.  31.]
    [ 19.  23.  25.]
    [ 20.  22.  24.  25.]
    [ 23.  24.  25.  26.  27.]
    [ 11.  12.  13.]
    [ 16.]
    [ 25.]
    [ 20.]
    [ 23.  24.]
    [ 22.  23.  24.]
    [ 16.  17.  25.]
    [ 20.  21.  22.  23.]
    [  9.  15.  16.]
    [  6.  10.  12.  14.]
    [ 22.]
    [ 12.  13.  14.  15.  17.  20.  23.]
    [  9.  10.  11.  20.  21.  22.  24.]
    [ 19.]
    [  9.  11.  12.  13.  14.  15.  16.  18.]
    [ 20.  22.]
    [ 15.  19.]
    [ 22.]
    [ 17.  18.]
    [ 30.  31.]
    [ 11.  13.  16.  17.  20.]
    [ 18.  20.  21.  23.  29.]
    [  4.   9.  10.  11.  13.]
    [ 18.  19.]
    [ 23.  29.  30.  31.]
    [ 11.  13.  14.  20.  21.  23.]
    [ 11.]
    [ 26.  29.]
    [ 14.  15.  16.  20.]
    [ 10.  11.  12.  13.]
    [ 17.]
    [ 18.  19.]
    [ 23.]
    [ 14.  15.  20.  22.  23.  24.  25.  26.  28.  29.]
    [ 20.  22.]
    [ 13.  16.]
    [ 15.  17.  18.  20.]
    [ 22.]
    [ 11.  12.  13.  14.  15.  16.  17.]
    [ 14.]
    [ 19.  20.  21.]
    [ 28.  29.  30.  31.]
    [ 30.  31.]
    [ 20.  21.  24.]
    [ 14.  17.  18.]
    [ 21.  22.]
    [ 24.  25.  26.  28.]
    [31]
    [ 22.  27.  28.]
    [ 20.  21.  22.  24.  25.]
    [ 18.  19.  20.  21.  22.  23.  24.  25.  26.]
    [ 18.  20.  28.]
    [ 23.  31.]
    [ 16.  22.]
    [ 16.  17.]
    [ 22.  23.]
    [31]
    [ 16.  17.]
    [ 15.]
    [ 20.  25.  27.]
    [ 24.]
    [ 15.  16.  17.  19.  27.  28.]
    [ 17.  22.]
    [ 23.]
    [ 16.  18.]
    [ 21.  27.]
    [ 21.  22.  23.]
    [ 24.]
    [ 18.  19.  22.  23.  24.  25.  26.]
    [ 21.  27.]
    [  3.   5.   6.   8.   9.  10.  11.  12.  13.  14.  15.  16.  17.]
    [ 9.]
    [ 18.  20.  21.  22.]
    [ 21.  22.]
    [ 12.  13.  14.  15.  16.]
    [ 29.  30.  31.]
    [ 18.]
    [ 27.  28.  29.  30.  31.]
    [ 22.  23.  24.]
    [ 18.]
    [ 15.  19.  20.  22.  27.]
    [ 30.]
    [ 22.  25.  27.  28.  29.  30.  31.]
    [ 22.  25.]
    [ 29.]
    [ 26.  29.]
    [ 7.  8.]
    [ 10.  19.  27.]
    [ 23.  26.  29.  31.]
    [ 11.]
    [ 27.  28.  29.  31.]
    [ 22.  23.  25.  29.]
    [ 11.  12.  13.  16.  17.  19.]
    [ 10.]
    [ 15.  20.  30.]
    [ 27.  29.  31.]
    [ 31.]
    [ 29.]
    [ 13.  16.  17.  19.  22.]
    [ 13.  18.]
    [31]
    [ 22.  23.  24.  25.  26.]
    [ 21.]
    [ 12.  14.  15.  16.  17.  18.  19.  20.  21.]
    [ 27.  29.  30.  31.]
    [ 13.  15.  17.  18.  19.  20.  21.  22.  23.]
    [ 16.  18.  21.  23.]
    [31]
    [ 31.]
    [ 26.]
    [ 30.]
    [ 19.  21.  23.  24.  26.]
    [ 19.  20.  21.]
    [ 28.]
    [ 14.  24.  25.  27.]
    [ 14.  15.  16.  17.  18.]
    [ 20.]
    [ 20.  23.  24.  25.  26.  27.  28.]
    [ 16.  19.  20.]
    [ 22.  23.  25.  28.  29.  31.]
    [ 21.  27.  28.  29.]
    [ 23.  24.  25.  26.  27.]
    [  4.   8.   9.  10.  11.]
    [  9.  10.  11.  13.]
    [ 19.  20.  22.  23.  24.  30.  31.]
    [ 16.  21.  24.  27.]
    [ 25.  31.]
    [ 27.  29.  30.]
    [ 15.  31.]
    [ 23.  24.]
    [ 29.  31.]
    [ 13.  14.]
    [ 21.  22.]
    [31]
    [ 15.]
    [ 19.  26.  27.]
    [ 18.]
    [ 16.  17.  23.]
    [ 22.  23.  24.  28.  31.]
    [ 22.  23.  25.  26.  28.]
    [ 30.  31.]
    [ 20.  24.]
    [ 22.  25.  27.]
    [ 17.  19.  20.  21.  23.  24.]
    [ 25.]
    [ 12.  13.  14.  15.  16.  17.  18.  20.]
    [  6.   8.   9.  12.  13.  14.  15.  16.  17.  18.  19.]
    [ 23.  26.]
    [ 25.]
    [ 15.  18.]
    [ 15.  16.  18.  19.  20.  24.]
    [ 27.  28.]
    [ 28.  30.]
    [ 28.  29.]
    [ 10.]
    [ 22.  23.  24.  25.  26.  27.  28.  29.  31.]
    [31]
    [ 19.  21.  24.]
    [ 13.  15.  16.  19.  20.  21.  23.]
    [  8.   9.  15.]
    [  2.   5.  12.  14.  15.  16.]
    [ 17.  18.  20.  21.  23.  27.]
    [ 14.  15.  17.  18.  20.  21.  22.  23.  24.  25.  26.]
    [ 13.  14.]
    [ 19.  21.]
    [31]
    [ 27.  31.]
    [31]
    [ 22.  24.  25.  26.]
    [ 22.  24.  25.  26.  29.  30.  31.]
    [ 27.  28.]
    [ 14.  15.  16.  17.  18.  19.  20.  21.  24.  26.]
    [ 16.  23.  24.  25.  26.]
    [0]
    [ 17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.  28.  29.  30.  31.]
    [31]
    [ 17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.]
    [ 24.  27.  28.  29.  30.  31.]
    [ 29.  31.]
    [ 15.  16.]
    [ 18.  19.  20.  22.]
    [ 14.]
    [ 15.  16.  17.  18.  19.]
    [  8.   9.  10.  11.  12.  13.  14.  15.  16.  17.]
    [ 23.  26.]
    [ 20.  23.  25.]
    [  9.  10.]
    [  8.  13.  14.  15.  19.  20.]
    [ 16.  17.  18.  19.  21.]
    [ 29.]
    [ 15.]
    [ 22.  23.  27.  28.]
    [ 27.]
    [ 10.  12.]
    [  8.  16.  18.]
    [31]
    [ 31.]
    [ 29.  31.]
    [ 23.]
    [ 11.  15.  16.  17.  18.  20.  22.  25.  26.]
    [ 21.  22.  25.]
    [ 13.  21.  23.  24.  27.  28.  30.]
    [ 21.  22.  23.  24.]
    [  9.  10.  11.  13.  15.  19.  22.  23.]
    [  7.   8.   9.  12.]
    [ 10.  15.]
    [ 13.  14.  16.  17.  20.]
    [ 30.  31.]
    [ 21.  22.  23.  31.]
    [ 18.  19.  20.  21.  22.  23.  24.  25.  26.]
    [ 11.  12.  13.  14.  15.  17.  19.]
    [ 10.]
    [ 21.  22.  23.  24.  28.]
    [ 21.  22.  23.]
    [ 29.]
    [ 27.  28.]
    [ 28.  30.  31.]
    [ 25.]
    [ 15.  18.  19.  22.]
    [ 19.  20.  21.  22.  23.  25.  26.  28.  30.  31.]
    [31]
    [31]
    [31]
    [ 27.  28.  29.  31.]
    [ 11.  13.  14.  17.]
    [ 29.  31.]
    [ 15.  16.  17.  18.  19.  20.]
    [ 18.]
    [ 19.  21.  22.]
    [ 22.  23.]
    [ 29.  30.  31.]
    [ 30.  31.]
    [ 20.  21.  25.]
    [ 26.  27.  28.  29.  30.]
    [ 16.  17.  18.  19.  20.  22.]
    [ 22.  23.]
    [ 23.  24.  25.  26.]
    [ 17.  23.]
    [31]
    [31]
    [31]
    [31]
    [ 12.  18.  21.  22.  23.  24.  25.  26.  27.  28.  29.  31.]
    [31]
    [31]
    [31]
    [31]
    [ 24.  25.  27.]
    [ 28.]
    [ 25.  26.  28.]
    [ 25.  29.]
    [ 28.  31.]
    [ 23.  24.  25.  27.]
    [ 23.]
    [ 27.  28.  29.]
    [  8.  12.  13.  15.  16.  17.  18.  22.]
    [ 13.  17.  19.  20.  22.  23.  24.  25.  26.]
    [ 23.  27.  28.  29.  30.]
    [ 17.  19.  21.  25.  28.]
    [ 25.]
    [ 14.  17.  18.  19.  20.  21.  22.  23.  24.  25.]
    [ 12.  13.  17.  18.  20.  22.]
    [ 19.]
    [  7.   9.  10.  11.  13.  20.  21.  29.]
    [  5.   7.   8.   9.  10.  11.  12.  13.  14.  15.  16.  17.  18.  20.  25.]
    [ 15.  16.  17.  18.  19.]
    [ 10.  12.  16.]
    [ 29.]
    [ 25.  27.  30.]
    [ 24.]
    [ 14.  16.  19.  20.  22.  23.  24.  25.  26.  31.]
    [ 29.  31.]
    [ 13.  15.  19.]
    [ 14.  16.  17.  18.  19.  20.  21.  25.]
    [ 27.]
    [ 23.]
    [  9.  10.  11.  13.  14.  15.  17.  18.  19.  20.  21.  22.  23.]
    [ 27.]
    [ 24.  27.]
    [ 30.]
    [  7.   8.  16.  22.]
    [ 20.  24.  25.]
    [ 24.]
    [ 17.  22.  23.  25.]
    [ 22.  23.  24.  26.  27.  28.  29.]
    [ 24.  30.]
    [ 26.  27.  29.  30.]
    [ 27.  28.  30.]
    [ 17.  18.  21.  22.  24.]
    [ 18.  19.  20.  21.  22.  23.  24.  25.  26.  27.  28.  29.]
    [ 23.  26.  28.]
    [ 12.]
    [ 24.  27.]
    [  9.  10.  11.  12.  13.  14.  15.  16.  17.  19.]
    [ 13.]
    [ 22.  24.  27.]
    [ 13.  20.  23.  26.]
    [ 20.  21.  22.  23.  24.]
    [ 15.  17.  20.  21.  22.  23.  24.  25.]
    [ 16.  17.  18.  19.]
    [ 8.]
    [ 12.  13.  14.  15.  16.  18.  20.]
    [ 21.  22.]
    [ 18.  21.]
    [ 22.  24.]
    [ 21.  25.]
    [ 23.]
    [ 29.  30.]
    [ 18.  20.  21.  23.  24.  28.]
    [ 26.]
    [31]
    [ 9.]
    [  8.   9.  11.]
    [ 16.  17.  21.]
    [ 21.  22.  23.  24.  25.  27.]
    [ 10.  14.  15.  16.  17.  18.  19.  20.  21.  22.]
    [  5.  14.  16.]
    [ 10.  11.  16.  17.  18.  19.  20.  21.  22.  24.]
    [ 17.  18.  19.  22.  23.  24.  25.]
    [ 9.]
    [ 20.  21.  22.  23.  27.]
    [31]
    [ 16.  17.  19.]
    [ 15.]
    [ 13.  14.  18.  19.  22.]
    [ 8.]
    [ 13.  15.  16.  17.  19.  21.]
    [ 21.  22.]
    [31]
    [ 28.]
    [31]
    [ 21.  23.]
    [ 26.]
    [ 24.  26.]
    [ 17.  19.  22.  24.  25.  26.  27.  28.  29.  30.]
    [31]
    [ 17.  19.  21.  22.]
    [ 21.  25.]
    [ 16.  21.  22.]
    [0]
    [  6.   7.   9.  22.]
    [31]
    [ 19.  20.  21.  22.  23.  24.  25.  27.  28.  31.]
    [ 18.]
    [ 18.  20.  22.  23.  24.  25.  26.]
    [ 18.  19.  20.  23.]
    [ 18.  19.  20.]
    [ 19.  20.  21.  22.  23.  24.  25.]
    [ 18.]
    [ 13.  16.  18.  19.  20.  21.]
    [ 12.  14.]
    [ 21.  25.]
    [ 23.  24.  25.]
    [ 18.  21.  23.  24.  25.]
    [ 14.  16.  17.  18.  19.  20.  21.  22.  23.  24.]
    [ 14.  16.]
    [  9.  11.  13.  14.  15.  16.  17.  18.  19.  20.]
    [  6.  11.  12.  13.  14.  15.  16.  17.  18.  20.]
    [31]
    [ 24.  25.  27.  28.  30.  31.]
    [ 30.  31.]
    [ 28.  29.  30.]
    [ 29.  30.  31.]
    [ 31.]
    [ 15.  17.]
    [ 21.  27.  28.]
    [ 20.  21.  27.]
    [ 18.  19.  20.  21.  22.  28.  31.]
    [ 20.]
    [31]
    [ 30.  31.]
    [ 26.]
    [ 11.  12.  14.]
    [31]
    [ 13.  18.  21.]
    [ 17.  19.  20.]
    [ 17.]
    [ 19.  20.  22.  23.  24.  27.]
    [ 17.  19.]
    [ 12.  14.  15.]
    [31]
    [0]
    [  9.  11.]
    [ 17.]
    [  9.  16.]
    [ 23.  25.  27.  28.  30.]
    [ 15.  18.]
    [ 27.]
    [ 24.]
    [ 18.  23.  24.  25.]
    [ 24.]
    [ 10.  11.  12.  13.  15.  16.  27.  31.]
    [31]
    [31]
    [ 17.  22.  23.  24.  25.  26.  28.]
    [31]
    [ 17.]
    [ 13.  15.  18.  19.  25.  28.]
    [ 16.  18.  21.]
    [  4.   6.   8.   9.  12.  13.  14.  17.]
    [ 18.  19.]
    [31]
    [31]
    [ 25.  26.  28.  30.  31.]
    [ 30.]
    [ 10.  12.]
    [31]
    [ 19.  21.  23.  24.  25.  26.  27.  28.  29.  30.  31.]
    [31]
    [ 18.]
    [ 21.]
    [31]
    [ 30.  31.]
    [31]
    [  9.  11.  14.  17.]
    [ 26.  31.]
    [ 26.  29.  30.  31.]
    [ 13.  14.]
    [ 20.]
    [ 15.  16.  17.  18.  21.]
    [ 30.]
    [ 12.]
    [ 25.  28.  29.  30.  31.]
    [ 20.  21.  24.  27.  29.]
    [ 14.  16.  19.  20.  22.  23.]
    [  9.  13.  14.  15.  16.  18.]
    [ 29.  30.  31.]
    [ 25.  26.  27.  28.  29.]
    [ 26.  27.  28.  29.  30.]
    [ 28.  31.]
    [ 23.  24.]
    [ 24.]
    [ 25.  26.  29.  30.]
    [ 26.  27.  30.]
    [ 23.  26.  29.]
    [ 29.  31.]
    [  8.  11.  14.  15.  16.  18.  19.  21.]
    [ 18.  20.  22.  23.]
    [ 21.]
    [ 22.]
    [ 26.  27.  28.  31.]
    [ 18.  22.  26.]
    [ 26.  27.  28.  29.  30.]
    [ 20.  25.]
    [ 23.]
    [ 26.  28.]
    [ 16.  17.  20.]
    [ 17.]
    [ 20.]
    [ 15.  18.  19.]
    [ 16.  17.  18.  19.  20.]
    [ 27.  31.]
    [ 21.  23.]
    [ 18.  20.  24.  25.  26.]
    [ 18.  19.  20.  21.  22.  23.  24.  25.]
    [ 18.  20.]
    [ 19.  20.]
    [ 15.  18.]
    [ 19.  20.  21.  23.  25.  26.]
    [ 15.  16.  19.]
    [ 16.  21.]
    [ 28.]
    [ 30.  31.]
    [ 21.  22.  23.  24.]
    [ 13.  16.]
    [ 12.  13.  14.  15.  16.  17.  20.  21.  22.  23.]
    [  8.   9.  10.  11.  12.  13.  14.  15.  16.]
    [ 16.]
    [31]
    [ 22.  23.  24.]
    [31]
    [ 18.  20.  21.  22.  23.  24.]
    [ 15.  18.  19.]
    [  9.  10.  11.  12.  13.  14.  15.  16.  17.  18.  19.]
    [  9.  10.  11.]
    [  8.  11.  15.]
    [ 22.]
    [ 12.  18.]
    [ 5.]
    [ 11.  24.]
    [ 10.  11.  12.  14.  16.  18.]
    [ 15.  16.  17.  18.  20.  21.  24.]
    [ 28.  30.  31.]
    [ 23.]
    [ 14.  16.  18.  19.  20.  21.  22.  23.  25.]
    [31]
    [ 27.  28.]
    [ 24.  27.  28.]
    [ 12.]
    [ 11.  14.  16.  17.]
    [ 13.  14.  15.  17.  18.  19.  31.]
    [ 13.  15.  16.  17.  18.  19.]
    [ 13.  14.  16.  17.  18.]
    [ 23.]
    [ 18.  19.  20.  21.  22.  23.  24.  25.]
    [ 16.  18.  19.  20.  21.  22.  23.]
    [ 11.  12.  13.  14.  15.]
    [ 19.  20.  21.  22.  23.  24.  25.  26.  27.  28.  29.]
    [ 19.  22.  23.  24.  25.  26.  27.  28.  29.  30.]
    [ 18.  20.  21.  23.  24.  26.  27.  30.]
    [ 24.  26.  28.  30.]
    [31]
    [31]
    [31]
    [31]
    [31]
    [31]
    [ 19.  23.  24.  25.  26.]
    [ 15.  26.]
    [ 19.  25.]
    [31]
    [31]
    [ 31.]
    [31]
    [ 25.]
    [ 19.  26.]
    [ 26.  27.  28.  29.  31.]
    [31]
    [31]
    [  7.  11.  13.  14.  15.  18.  19.]
    [ 26.]
    [31]
    [31]
    [31]
    [ 16.  17.  18.  19.  21.  22.  24.]
    [ 28.  31.]
    [31]
    [ 31.]
    [31]
    [  8.   9.  10.  11.  12.  13.  14.]
    [ 14.  17.  20.  21.]
    [ 24.  25.  27.  28.  30.]
    [ 13.  15.  16.  17.  23.]
    [ 15.  16.  17.  18.  19.  20.  22.  23.]
    [ 13.  17.  18.  19.  20.  21.  22.  23.]
    [ 12.  13.  14.  15.  16.  17.  18.  19.  20.  21.  23.  24.]
    [ 14.  16.]
    [  9.  14.  15.]
    [ 27.]
    [ 24.  25.]
    [ 14.]
    [  4.  14.  16.]
    [ 11.  12.  13.  20.  21.  22.  24.]
    [ 27.]
    [ 26.]
    [ 11.  13.  14.  15.  16.  17.  18.  19.  20.  21.  22.  23.]
    [ 19.]
    [  9.  12.  13.]
    [ 10.  11.  12.  13.  14.  15.  16.  18.]
    [  8.  10.  15.  17.  22.]
    [ 26.  29.  30.]
    [ 11.  13.  15.  17.  19.  22.]
    [ 10.]
    [ 15.  19.  21.  22.  24.  25.  26.]
    [ 14.  27.  28.]
    [ 17.  19.]
    [ 11.  17.]
    [ 22.  23.  25.  26.]
    [ 24.  25.  26.  27.  28.  31.]
    [ 20.  21.  22.  23.  24.  25.  26.]
    [ 21.  24.  25.  26.  27.  28.]
    [ 24.  25.  26.  27.  28.  29.]
    [ 27.  30.  31.]
    [ 19.  20.  21.  25.]
    [ 27.  30.  31.]
    [ 22.]
    [ 23.  24.  25.  26.  27.  28.  29.]
    [ 29.]
    [ 19.  22.  23.  25.  26.  27.  28.  29.  30.]
    [  8.  16.  18.  19.  20.]
    [ 18.  19.  21.]
    [ 20.]
    [ 23.  25.  26.  27.  28.  29.  31.]
    [ 14.  15.  16.]
    [ 11.  12.]
    [ 27.]
    [ 23.]
    [ 21.]
    [ 27.  28.  29.  30.  31.]
    [ 18.  21.]
    [ 13.  14.  16.  17.]
    [ 27.  31.]
    [31]
    [ 28.  29.  30.  31.]
    [31]
    [ 15.  16.  17.]
    [ 13.  16.  19.  20.  21.  23.  25.]
    [ 20.]
    [ 18.]
    [ 30.]
    [  9.  10.  12.  15.  16.  18.  19.  20.]
    [31]
    [31]
    [ 26.]
    [ 17.  19.  20.]
    [ 11.  12.  14.  15.  16.]
    [ 18.  20.  23.  25.]
    [ 20.]
    [ 21.  22.  23.  24.  25.  26.]
    [ 23.]
    [ 17.  18.  19.  21.  23.]
    [ 23.  25.  26.]
    [ 23.  26.]
    [ 12.  13.  14.  16.  17.  21.]
    [ 14.  21.]
    [ 13.  16.]
    [ 11.  12.  15.  16.  17.  18.  19.  20.  21.  22.]
    [31]
    


```python
observation_symbol=[]
for key,rssi in test_divde.items():
    
    for cellID,rssi in rssi:
        
        if [key,item] not in observation_symbol:
            
            observation_symbol.append([key,item])
```


```python
import math
```


```python
def angle2radian(angle):
    
    return math.pi*angle/180.0
```


```python
def distance_sphere(Lat1,Lon1,Lat2,Lon2):
    
    R = 6400000
    
    Lat1=angle2radian(Lat1)
    Lat2=angle2radian(Lat2)
    
    Lon1=angle2radian(Lon1)
    Lon2=angle2radian(Lon2)
    
    sita = math.acos(math.sin(Lat1)*math.sin(Lat2) + math.cos(Lat1)*math.cos(Lat2)*math.cos(Lon1-Lon2))
    
    if sita>1:
        sita = 1
    elif sita<-1:
        sita=-1
    
    return R* sita
```


```python
def distance_manhatton(Lat1,Lon1,Lat2,Lon2):
    
    return int(abs(Lat1-Lat2)+abs(Lon1-Lon2))
```


```python
trainsition_score=dict()

for key,coordinate in grid_coordinate.items():
    
    trainsition_score[key]=[]
    
    for other_key,other_coordinate in grid_coordinate.items():
        
        if key == other_key:
            
            trainsition_score[key].append(1)
        
        else:
            
            distance = distance_sphere(coordinate[1],coordinate[0],other_coordinate[1],other_coordinate[0])
            
            trainsition_score[key].append(1.0/distance)
```


```python
trainsition_matrix=np.array([trainsition_score[key] for key in trainsition_score.keys()])
```


```python
trainsition_matrix
```




    array([[  1.00000000e+00,   2.72861823e-03,   7.77510077e-04, ...,
              7.22699068e-04,   1.20138478e-03,   7.87046149e-04],
           [  2.72861823e-03,   1.00000000e+00,   1.05634888e-03, ...,
              9.82802260e-04,   1.78544692e-03,   6.72802613e-04],
           [  7.77510077e-04,   1.05634888e-03,   1.00000000e+00, ...,
              2.04023323e-03,   1.93015390e-03,   5.07534724e-04],
           ..., 
           [  7.22699068e-04,   9.82802260e-04,   2.04023323e-03, ...,
              1.00000000e+00,   1.18523964e-03,   4.31551609e-04],
           [  1.20138478e-03,   1.78544692e-03,   1.93015390e-03, ...,
              1.18523964e-03,   1.00000000e+00,   6.75062448e-04],
           [  7.87046149e-04,   6.72802613e-04,   5.07534724e-04, ...,
              4.31551609e-04,   6.75062448e-04,   1.00000000e+00]])




```python
for i in range(len(trainsition_matrix)):
    
    trainsition_item=trainsition_matrix[i]
    
    sum = 0
    
    for item in trainsition_item:
        
        sum += item
    
    for j in range(len(trainsition_item)):
        
        trainsition_item[j] /= sum
```


```python
sum = 0
for item in trainsition_matrix[-1]:
    sum += item
print sum
```

    1.0
    


```python
type(observation_symbol)
```




    list




```python
a=dict()
a[1]=[1,2,3]
a[2]=[1,2,3]
count = 0
for key,items in a.items():
    
    if key == 2:
        print (count)
    
    count +=1
    
```

    1
    


```python
emission_score=dict()
for gridID,records in test_divde.items():
    
    emission_score[gridID] = [0]*len(observation_symbol)
    
    
    
    for cellID,rssiList in records.items():
        
      
        if len(rssiList)==1:
            
            index = observation_symbol.index([cellID,rssiList[0]])
            
            emission_score[gridID][index] = 1
        else:
            
            for i in range(len(rssiList)):

                ep_list=[]

                for j in range(len(rssiList)):

                    if i == j:
                        continue

                    ep = 3 + (32 - abs(rssiList[i] - rssiList[j]))

                    ep_list.append(ep)


                index = observation_symbol.index([cellID,rssiList[i]])

                emission_score[gridID][index] += max(ep_list)


            
        
    
    
```


```python
emission_matrix=np.array([emission_score[key]for key in emission_score.keys()])
```


```python
sum = 0

for item in emission_matrix[-1]:
   
    sum += item

print sum
```

    1.0
    


```python
for i in range(len(emission_matrix)):
    
    emission_item=emission_matrix[i]
    
    sum = 0
    
    for item in emission_item:
        
        sum += item
    
    for j in range(len(emission_item)):
        
        emission_item[j] /= float(sum)
```


```python
len(trainsition_matrix)
```




    847




```python
grid_dic=dict()
count = 0
for key in test_divde.keys():
    
    grid_dic[count]=key
    
    count+=1
```


```python
grid_dic
```




    {0: 0,
     1: 2,
     2: 3,
     3: 4,
     4: 5,
     5: 6,
     6: 7,
     7: 8,
     8: 10,
     9: 11,
     10: 12,
     11: 13,
     12: 14,
     13: 15,
     14: 16,
     15: 17,
     16: 18,
     17: 19,
     18: 20,
     19: 21,
     20: 22,
     21: 23,
     22: 24,
     23: 25,
     24: 26,
     25: 27,
     26: 28,
     27: 29,
     28: 30,
     29: 31,
     30: 32,
     31: 33,
     32: 34,
     33: 35,
     34: 36,
     35: 37,
     36: 39,
     37: 40,
     38: 41,
     39: 42,
     40: 43,
     41: 44,
     42: 45,
     43: 46,
     44: 47,
     45: 48,
     46: 49,
     47: 50,
     48: 51,
     49: 52,
     50: 53,
     51: 54,
     52: 55,
     53: 56,
     54: 57,
     55: 58,
     56: 59,
     57: 61,
     58: 62,
     59: 63,
     60: 64,
     61: 65,
     62: 66,
     63: 67,
     64: 68,
     65: 70,
     66: 71,
     67: 72,
     68: 73,
     69: 74,
     70: 75,
     71: 76,
     72: 77,
     73: 78,
     74: 79,
     75: 80,
     76: 81,
     77: 82,
     78: 83,
     79: 84,
     80: 85,
     81: 86,
     82: 87,
     83: 89,
     84: 90,
     85: 91,
     86: 92,
     87: 93,
     88: 94,
     89: 95,
     90: 96,
     91: 97,
     92: 98,
     93: 99,
     94: 100,
     95: 101,
     96: 102,
     97: 103,
     98: 104,
     99: 105,
     100: 106,
     101: 107,
     102: 108,
     103: 109,
     104: 110,
     105: 111,
     106: 112,
     107: 113,
     108: 114,
     109: 115,
     110: 116,
     111: 117,
     112: 118,
     113: 119,
     114: 120,
     115: 121,
     116: 122,
     117: 123,
     118: 124,
     119: 125,
     120: 126,
     121: 127,
     122: 128,
     123: 129,
     124: 130,
     125: 131,
     126: 132,
     127: 133,
     128: 134,
     129: 135,
     130: 136,
     131: 137,
     132: 138,
     133: 139,
     134: 140,
     135: 141,
     136: 142,
     137: 143,
     138: 144,
     139: 145,
     140: 146,
     141: 147,
     142: 149,
     143: 150,
     144: 151,
     145: 152,
     146: 153,
     147: 154,
     148: 155,
     149: 156,
     150: 157,
     151: 158,
     152: 159,
     153: 160,
     154: 161,
     155: 162,
     156: 163,
     157: 164,
     158: 165,
     159: 166,
     160: 167,
     161: 168,
     162: 170,
     163: 171,
     164: 172,
     165: 173,
     166: 174,
     167: 175,
     168: 176,
     169: 177,
     170: 178,
     171: 179,
     172: 180,
     173: 181,
     174: 182,
     175: 183,
     176: 184,
     177: 185,
     178: 186,
     179: 187,
     180: 188,
     181: 189,
     182: 190,
     183: 191,
     184: 192,
     185: 194,
     186: 195,
     187: 196,
     188: 197,
     189: 198,
     190: 199,
     191: 200,
     192: 201,
     193: 202,
     194: 203,
     195: 204,
     196: 205,
     197: 206,
     198: 207,
     199: 208,
     200: 209,
     201: 210,
     202: 211,
     203: 212,
     204: 213,
     205: 214,
     206: 215,
     207: 216,
     208: 217,
     209: 218,
     210: 219,
     211: 220,
     212: 221,
     213: 222,
     214: 223,
     215: 225,
     216: 226,
     217: 227,
     218: 228,
     219: 229,
     220: 230,
     221: 231,
     222: 232,
     223: 233,
     224: 234,
     225: 235,
     226: 236,
     227: 237,
     228: 238,
     229: 239,
     230: 240,
     231: 241,
     232: 242,
     233: 243,
     234: 244,
     235: 246,
     236: 247,
     237: 248,
     238: 249,
     239: 250,
     240: 251,
     241: 253,
     242: 254,
     243: 255,
     244: 256,
     245: 257,
     246: 258,
     247: 259,
     248: 260,
     249: 261,
     250: 262,
     251: 263,
     252: 264,
     253: 266,
     254: 267,
     255: 268,
     256: 269,
     257: 270,
     258: 271,
     259: 272,
     260: 273,
     261: 274,
     262: 275,
     263: 276,
     264: 277,
     265: 279,
     266: 280,
     267: 281,
     268: 282,
     269: 283,
     270: 284,
     271: 285,
     272: 286,
     273: 287,
     274: 288,
     275: 289,
     276: 290,
     277: 291,
     278: 292,
     279: 293,
     280: 294,
     281: 295,
     282: 296,
     283: 297,
     284: 298,
     285: 300,
     286: 301,
     287: 302,
     288: 303,
     289: 304,
     290: 305,
     291: 306,
     292: 307,
     293: 308,
     294: 309,
     295: 310,
     296: 311,
     297: 312,
     298: 313,
     299: 314,
     300: 315,
     301: 316,
     302: 317,
     303: 318,
     304: 319,
     305: 320,
     306: 321,
     307: 322,
     308: 323,
     309: 324,
     310: 325,
     311: 326,
     312: 327,
     313: 328,
     314: 329,
     315: 330,
     316: 331,
     317: 332,
     318: 333,
     319: 334,
     320: 336,
     321: 337,
     322: 338,
     323: 339,
     324: 340,
     325: 341,
     326: 342,
     327: 343,
     328: 344,
     329: 345,
     330: 346,
     331: 347,
     332: 348,
     333: 349,
     334: 350,
     335: 351,
     336: 352,
     337: 353,
     338: 354,
     339: 355,
     340: 356,
     341: 358,
     342: 359,
     343: 360,
     344: 361,
     345: 362,
     346: 364,
     347: 365,
     348: 366,
     349: 367,
     350: 368,
     351: 369,
     352: 371,
     353: 372,
     354: 373,
     355: 374,
     356: 375,
     357: 376,
     358: 377,
     359: 378,
     360: 380,
     361: 381,
     362: 382,
     363: 383,
     364: 384,
     365: 385,
     366: 386,
     367: 387,
     368: 388,
     369: 389,
     370: 390,
     371: 392,
     372: 393,
     373: 394,
     374: 395,
     375: 396,
     376: 397,
     377: 398,
     378: 399,
     379: 400,
     380: 401,
     381: 402,
     382: 403,
     383: 404,
     384: 405,
     385: 406,
     386: 407,
     387: 408,
     388: 409,
     389: 410,
     390: 411,
     391: 412,
     392: 413,
     393: 414,
     394: 415,
     395: 416,
     396: 418,
     397: 419,
     398: 420,
     399: 421,
     400: 422,
     401: 423,
     402: 424,
     403: 425,
     404: 426,
     405: 427,
     406: 428,
     407: 429,
     408: 430,
     409: 431,
     410: 432,
     411: 433,
     412: 434,
     413: 435,
     414: 436,
     415: 437,
     416: 438,
     417: 439,
     418: 440,
     419: 441,
     420: 442,
     421: 443,
     422: 444,
     423: 445,
     424: 446,
     425: 447,
     426: 448,
     427: 449,
     428: 450,
     429: 451,
     430: 452,
     431: 453,
     432: 454,
     433: 455,
     434: 456,
     435: 457,
     436: 458,
     437: 459,
     438: 460,
     439: 461,
     440: 462,
     441: 463,
     442: 464,
     443: 465,
     444: 466,
     445: 467,
     446: 468,
     447: 469,
     448: 470,
     449: 471,
     450: 472,
     451: 473,
     452: 474,
     453: 475,
     454: 476,
     455: 477,
     456: 478,
     457: 479,
     458: 480,
     459: 481,
     460: 482,
     461: 483,
     462: 484,
     463: 485,
     464: 486,
     465: 488,
     466: 489,
     467: 490,
     468: 491,
     469: 492,
     470: 494,
     471: 495,
     472: 496,
     473: 497,
     474: 498,
     475: 499,
     476: 500,
     477: 502,
     478: 503,
     479: 504,
     480: 505,
     481: 506,
     482: 507,
     483: 508,
     484: 509,
     485: 510,
     486: 511,
     487: 512,
     488: 513,
     489: 514,
     490: 515,
     491: 516,
     492: 517,
     493: 518,
     494: 519,
     495: 520,
     496: 521,
     497: 522,
     498: 523,
     499: 524,
     500: 525,
     501: 526,
     502: 527,
     503: 528,
     504: 529,
     505: 530,
     506: 531,
     507: 532,
     508: 533,
     509: 534,
     510: 535,
     511: 536,
     512: 537,
     513: 538,
     514: 540,
     515: 541,
     516: 542,
     517: 543,
     518: 544,
     519: 545,
     520: 546,
     521: 547,
     522: 548,
     523: 550,
     524: 551,
     525: 552,
     526: 553,
     527: 554,
     528: 557,
     529: 558,
     530: 559,
     531: 560,
     532: 561,
     533: 562,
     534: 563,
     535: 564,
     536: 565,
     537: 566,
     538: 567,
     539: 568,
     540: 569,
     541: 570,
     542: 571,
     543: 572,
     544: 573,
     545: 574,
     546: 575,
     547: 576,
     548: 578,
     549: 579,
     550: 580,
     551: 581,
     552: 582,
     553: 583,
     554: 584,
     555: 585,
     556: 586,
     557: 587,
     558: 588,
     559: 589,
     560: 590,
     561: 591,
     562: 592,
     563: 593,
     564: 594,
     565: 595,
     566: 596,
     567: 597,
     568: 598,
     569: 599,
     570: 600,
     571: 601,
     572: 602,
     573: 603,
     574: 604,
     575: 605,
     576: 606,
     577: 607,
     578: 608,
     579: 609,
     580: 610,
     581: 611,
     582: 612,
     583: 613,
     584: 614,
     585: 615,
     586: 616,
     587: 617,
     588: 618,
     589: 619,
     590: 620,
     591: 621,
     592: 622,
     593: 623,
     594: 624,
     595: 625,
     596: 626,
     597: 627,
     598: 628,
     599: 629,
     600: 630,
     601: 631,
     602: 632,
     603: 633,
     604: 634,
     605: 635,
     606: 636,
     607: 637,
     608: 638,
     609: 639,
     610: 640,
     611: 641,
     612: 642,
     613: 643,
     614: 644,
     615: 645,
     616: 646,
     617: 647,
     618: 648,
     619: 649,
     620: 650,
     621: 651,
     622: 652,
     623: 654,
     624: 655,
     625: 656,
     626: 657,
     627: 658,
     628: 659,
     629: 660,
     630: 662,
     631: 663,
     632: 664,
     633: 665,
     634: 666,
     635: 667,
     636: 669,
     637: 670,
     638: 671,
     639: 672,
     640: 673,
     641: 674,
     642: 675,
     643: 676,
     644: 677,
     645: 678,
     646: 679,
     647: 680,
     648: 681,
     649: 682,
     650: 683,
     651: 684,
     652: 685,
     653: 686,
     654: 687,
     655: 688,
     656: 689,
     657: 690,
     658: 691,
     659: 692,
     660: 693,
     661: 694,
     662: 695,
     663: 696,
     664: 697,
     665: 698,
     666: 699,
     667: 700,
     668: 701,
     669: 702,
     670: 703,
     671: 705,
     672: 706,
     673: 707,
     674: 708,
     675: 709,
     676: 710,
     677: 711,
     678: 712,
     679: 713,
     680: 714,
     681: 715,
     682: 716,
     683: 717,
     684: 718,
     685: 719,
     686: 720,
     687: 721,
     688: 722,
     689: 723,
     690: 724,
     691: 725,
     692: 726,
     693: 727,
     694: 728,
     695: 729,
     696: 730,
     697: 731,
     698: 732,
     699: 733,
     700: 734,
     701: 735,
     702: 736,
     703: 737,
     704: 739,
     705: 741,
     706: 742,
     707: 744,
     708: 745,
     709: 746,
     710: 747,
     711: 748,
     712: 749,
     713: 750,
     714: 751,
     715: 752,
     716: 753,
     717: 754,
     718: 755,
     719: 756,
     720: 757,
     721: 758,
     722: 759,
     723: 760,
     724: 761,
     725: 762,
     726: 763,
     727: 764,
     728: 765,
     729: 766,
     730: 767,
     731: 768,
     732: 769,
     733: 770,
     734: 771,
     735: 772,
     736: 773,
     737: 774,
     738: 775,
     739: 776,
     740: 777,
     741: 778,
     742: 779,
     743: 780,
     744: 781,
     745: 782,
     746: 783,
     747: 784,
     748: 786,
     749: 787,
     750: 788,
     751: 789,
     752: 790,
     753: 791,
     754: 792,
     755: 793,
     756: 794,
     757: 795,
     758: 796,
     759: 797,
     760: 798,
     761: 799,
     762: 800,
     763: 801,
     764: 802,
     765: 803,
     766: 805,
     767: 806,
     768: 807,
     769: 808,
     770: 809,
     771: 810,
     772: 811,
     773: 812,
     774: 813,
     775: 814,
     776: 815,
     777: 816,
     778: 817,
     779: 818,
     780: 819,
     781: 820,
     782: 821,
     783: 822,
     784: 824,
     785: 825,
     786: 826,
     787: 828,
     788: 829,
     789: 830,
     790: 831,
     791: 832,
     792: 833,
     793: 834,
     794: 835,
     795: 836,
     796: 837,
     797: 838,
     798: 839,
     799: 840,
     800: 841,
     801: 842,
     802: 843,
     803: 844,
     804: 845,
     805: 846,
     806: 847,
     807: 848,
     808: 850,
     809: 851,
     810: 852,
     811: 853,
     812: 854,
     813: 855,
     814: 856,
     815: 857,
     816: 858,
     817: 859,
     818: 860,
     819: 861,
     820: 862,
     821: 863,
     822: 865,
     823: 866,
     824: 867,
     825: 868,
     826: 869,
     827: 870,
     828: 871,
     829: 872,
     830: 873,
     831: 874,
     832: 875,
     833: 876,
     834: 877,
     835: 878,
     836: 879,
     837: 880,
     838: 882,
     839: 883,
     840: 884,
     841: 885,
     842: 886,
     843: 887,
     844: 888,
     845: 889,
     846: 890}




```python
np.unique(emission_score[0])
```




    array([   0.,  105.,  140.,  245.,  350.])




```python
len(test_divde)
```




    847




```python
from hmmlearn import hmm
```


```python
model=hmm.MultinomialHMM(n_components=len(test_divde))
```


```python
startprob=np.array([1.0/len(trainsition_matrix)]*len(trainsition_matrix))
```


```python
model.startprob_=startprob
```


```python
model.transmat_=trainsition_matrix
```


```python
model.n_features=len(observation_symbol)
```


```python
model.emissionprob_=emission_matrix
```


```python
model.sample(100)

```




    (array([[ 827],
            [ 827],
            [ 699],
            [ 699],
            [ 699],
            [ 801],
            [ 856],
            [ 857],
            [ 857],
            [ 861],
            [ 861],
            [ 861],
            [ 136],
            [ 136],
            [1431],
            [1477],
            [1477],
            [1477],
            [ 235],
            [ 476],
            [1050],
            [ 880],
            [ 880],
            [ 891],
            [ 890],
            [ 890],
            [ 881],
            [ 988],
            [ 709],
            [ 853],
            [ 924],
            [ 924],
            [ 675],
            [ 707],
            [ 856],
            [ 856],
            [ 857],
            [1043],
            [1043],
            [1043],
            [1415],
            [1415],
            [1415],
            [ 317],
            [ 361],
            [ 215],
            [ 236],
            [1477],
            [ 521],
            [ 521],
            [ 857],
            [ 252],
            [ 252],
            [ 252],
            [ 252],
            [ 600],
            [1480],
            [1473],
            [1473],
            [ 968],
            [ 968],
            [ 767],
            [ 767],
            [1482],
            [1064],
            [1064],
            [ 654],
            [ 789],
            [ 788],
            [ 788],
            [ 651],
            [  57],
            [  55],
            [1042],
            [ 502],
            [ 502],
            [ 502],
            [1125],
            [ 128],
            [  56],
            [ 712],
            [ 701],
            [ 701],
            [ 701],
            [1014],
            [1014],
            [ 701],
            [ 648],
            [ 503],
            [ 503],
            [ 503],
            [ 503],
            [ 503],
            [ 482],
            [ 648],
            [ 648],
            [ 402],
            [ 788],
            [ 788],
            [ 734]], dtype=int64),
     array([495, 495, 579, 579, 579, 234, 583, 371, 113, 704, 704, 704, 390,
            390, 790, 747, 747, 747, 786,  43, 777, 393, 393, 844, 273, 273,
            748, 570,  80, 562, 240, 240, 614, 266, 830, 830, 122, 394, 394,
            394, 403, 403, 403, 377, 757, 368, 644, 573,  37,  37, 215, 615,
            615, 615, 615, 648, 527, 392, 392, 413, 413, 791, 791, 414, 595,
            595, 526, 353, 101, 101, 629, 546, 537, 293,   3,   3,   3, 506,
            300, 559, 314, 443, 443, 443, 636, 636, 803,  49,  93,  93,  93,
             93,  93,  22, 397, 397, 261, 598, 598, 533]))




```python
observation_symbol[827]
```




    [56, 31.0]




```python
base_station_list[56]
```




    [99096, 1]




```python
test_label=[]
```


```python
test_sequence=[]
```


```python
for i in range(len(test4G.Grid_ID)):
    
    if [test4G.SRNCID[i],test4G.BestCellID[i]] not in base_station_list:
        continue
    else:
        
        index = base_station_list.index([test4G.SRNCID[i],test4G.BestCellID[i]])
        
        rssi = test4G.EcNo_1[i] - test4G.RSCP_1[i]
        
        test_sequence.append([index,rssi])
        
        test_label.append(test4G.Grid_ID[i])
        
```


```python
len(test_label)
```




    8576




```python
test_rssi_list=[]
for item in test_sequence:
    
    test_rssi_list.append(item[1])
```


```python
min(test_rssi_list)
```




    40.0




```python
max(test_rssi_list)
```




    979.75




```python
test_rssi_list.sort()
```


```python
test_rssi_list[int(len(test_rssi_list)/2)]
```




    66.25




```python
np.mean(test_rssi_list)
```




    67.443138992537314




```python
test_sequence[0]
```




    [60, 76.620000000000005]




```python
min_test_rssi=min(test_rssi_list)
max_test_rssi=test_rssi_list[int(len(test_rssi_list)*0.8)]

for i in range(len(test_sequence)):
    
    rssi = test_sequence[i][1]
    
    rssi_new = round( ((rssi - min_test_rssi) / (max_test_rssi - min_test_rssi) * 31) )
    
    if rssi_new < 0:
        rssi_new = 0
        
    if rssi_new>31:
        
        rssi_new = 31
    
    test_sequence[i][1]=rssi_new
    
    
```


```python
test_sequence[0]
```




    [60, 31]




```python
final_test_sequence=[]
final_test_label=[]
for i in range(len(test_sequence)):
    
    if test_sequence[i] not in observation_symbol:
        continue
    else:
        
        index = observation_symbol.index(test_sequence[i])
        
        final_test_sequence.append([index])
        
        final_test_label.append(test_label[i])
```


```python
len(final_test_label)
```




    7558




```python
result_label=model.predict(final_test_sequence)
```


```python
final_result_label=[]
```


```python
result_label
```




    array([687, 687, 778, ..., 155, 760, 760])




```python
result_label[0]
```




    687




```python
for item in result_label:
    
    final_result_label.append(grid_dic[item])

```


```python
count = 0
for i in range(len(final_result_label)):
    
    if final_result_label[i]==final_test_label[i]:
        
        count+=1
```


```python
count
```




    1164




```python
len(final_result_label)
```




    7558




```python
observation_symbol[0]
```




    [0, 14.0]




```python
round(train4G.Longitude[0],2)
```




    121.49




```python
lon_list=[]
for item in train4G.Longitude:
    
    lon_list.append(round(item,3))
```


```python
np.unique(lon_list)
```




    array([ 121.476,  121.477,  121.478,  121.479,  121.48 ,  121.481,
            121.482,  121.483,  121.484,  121.485,  121.486,  121.487,
            121.488,  121.489,  121.49 ,  121.491,  121.492,  121.493,
            121.494,  121.495,  121.496,  121.497,  121.498,  121.499,
            121.5  ,  121.501,  121.502,  121.503])




```python
len(np.unique(lon_list))
```




    28




```python
lat_list=[]
for item in train4G.Latitude:
    
    lat_list.append(round(item,3))
```


```python
np.unique(lat_list)
```




    array([ 31.209,  31.21 ,  31.211,  31.212,  31.213,  31.214,  31.215,
            31.216,  31.217,  31.218,  31.219,  31.22 ,  31.221,  31.222,
            31.223,  31.224])




```python
len(np.unique(lat_list))
```




    16




```python
states_list=[]

coor_divide=dict()

for i in range(len(train4G.Grid_ID)):
    
    lon = round(train4G.Longitude[i],4)
    lat = round(train4G.Latitude[i],4)
    
    if [lon,lat] not in states_list:
        
        states_list.append([lon,lat])
        
    coorID = states_list.index([lon,lat])
    
    if coorID not in coor_divide.keys():
        
        coor_divide[coorID] = dict()
        
    cellID = base_station_list.index([train4G.SRNCID[i],train4G.BestCellID[i]])
    
    if cellID not in coor_divide[coorID]:
        
        coor_divide[coorID][cellID]=[]
    
    rssi = train4G.EcNo_1[i]- train4G.RSCP_1[i]
    
    coor_divide[coorID][cellID].append(rssi)
    
        
```


```python
len(states_list)
```




    2578




```python
states_list[0]
```




    [121.4934, 31.2174]




```python
single_transition=[]

for i in range(len(states_list)):
    
    single_transition.append([0]* len(states_list))
    
    for j in range(len(states_list)):
        
        if i==j:
            
            single_transition[i][j]=1
        else:
            
            single_transition[i][j]=1.0/distance_sphere(states_list[i][1],states_list[i][0],states_list[j][1],states_list[j][0])
            
            
```


```python
single_transition_matrix=np.array([item for item in single_transition])
```


```python
single_transition_matrix
```




    array([[ 1.        ,  0.0895271 ,  0.06803773, ...,  0.0023303 ,
             0.00204176,  0.00225206],
           [ 0.0895271 ,  1.        ,  0.1046798 , ...,  0.00238338,
             0.00208504,  0.00230902],
           [ 0.06803773,  0.1046798 ,  1.        , ...,  0.00235486,
             0.00206748,  0.00229842],
           ..., 
           [ 0.0023303 ,  0.00238338,  0.00235486, ...,  1.        ,
             0.0124237 ,  0.00668464],
           [ 0.00204176,  0.00208504,  0.00206748, ...,  0.0124237 ,
             1.        ,  0.008682  ],
           [ 0.00225206,  0.00230902,  0.00229842, ...,  0.00668464,
             0.008682  ,  1.        ]])




```python
for i in range(len(single_transition_matrix)):
    
    single_transition_item = single_transition_matrix[i]
    
    sum = 0
    
    for item in single_transition_item:
        
        sum += item

    
    for j in range(len(single_transition_item)):
        
      
        
        single_transition_item[j] /= sum
```


```python
single_transition_matrix
```




    array([[ 0.1557498 ,  0.01394383,  0.01059686, ...,  0.00036294,
             0.000318  ,  0.00035076],
           [ 0.01365173,  0.15248711,  0.01596232, ...,  0.00036343,
             0.00031794,  0.0003521 ],
           [ 0.01055183,  0.01623457,  0.15508792, ...,  0.00036521,
             0.00032064,  0.00035646],
           ..., 
           [ 0.00034692,  0.00035482,  0.00035058, ...,  0.14887444,
             0.00184957,  0.00099517],
           [ 0.00028793,  0.00029404,  0.00029156, ...,  0.00175202,
             0.14102209,  0.00122435],
           [ 0.0003223 ,  0.00033045,  0.00032894, ...,  0.00095667,
             0.00124252,  0.14311462]])




```python
len(coor_divide)
```




    2578




```python
coor_divide[0]
```




    {0: [59.369999999999997,
      60.369999999999997,
      59.0,
      60.869999999999997,
      59.499999999999993,
      60.369999999999997,
      59.869999999999997,
      63.369999999999997,
      63.0,
      61.619999999999997,
      60.119999999999997,
      61.249999999999993,
      61.999999999999993,
      59.369999999999997,
      60.369999999999997,
      59.0,
      60.869999999999997,
      59.499999999999993,
      60.369999999999997,
      59.869999999999997,
      63.369999999999997,
      63.0,
      61.619999999999997,
      60.119999999999997,
      61.249999999999993,
      61.999999999999993,
      59.369999999999997,
      60.369999999999997,
      59.0,
      60.869999999999997,
      59.499999999999993,
      60.369999999999997,
      59.869999999999997,
      63.369999999999997,
      63.0,
      61.619999999999997,
      60.119999999999997,
      61.249999999999993,
      61.999999999999993,
      62.379999999999995,
      58.869999999999997]}




```python
single_rssi_list=[]
for coorID,record in coor_divide.items():
    
    for cellID,rssiList in record.items():
        
        single_rssi_list.extend(rssiList)
```


```python
min(single_rssi_list)
```




    0.0




```python
max(single_rssi_list)
```




    979.0




```python
min_rssi=42.75
max_rssi=rssi_list[int(0.8*len(rssi_list))]

for coorID,records in coor_divide.items():
        
    for cellID,record in records.items():
        
        rssi_scale=[]
        
        for item in record:
            rssi = round( ((item - min_rssi) / (max_rssi - min_rssi) * 31) ) 

            if rssi<0:

                rssi = 0

            if rssi>31:

                rssi = 31

            rssi_scale.append(rssi)

        coor_divide[coorID][cellID]=rssi_scale
```


```python
single_observation_symbol=[]
for coorID,records in coor_divide.items():
    
    for cellID,rssi in records.items():
        
        for item in rssi:
        
            if [cellID,item] not in single_observation_symbol:
            
                single_observation_symbol.append([cellID,item])
```


```python
len(single_observation_symbol)
```




    1670




```python
single_observation_symbol[0]
```




    [0, 14.0]




```python
single_emission_score=dict()
for gridID,records in coor_divide.items():
    
    single_emission_score[gridID] = [0]*len(single_observation_symbol)
    
    
    
    for cellID,rssiList in records.items():
        
      
        if len(rssiList)==1:
            
            index = single_observation_symbol.index([cellID,rssiList[0]])
            
            single_emission_score[gridID][index] = 1
        else:
            
            for i in range(len(rssiList)):

                ep_list=[]

                for j in range(len(rssiList)):

                    if i == j:
                        continue

                    ep = 3 + (32 - abs(rssiList[i] - rssiList[j]))

                    ep_list.append(ep)


                index = single_observation_symbol.index([cellID,rssiList[i]])

                single_emission_score[gridID][index] += max(ep_list)
```


```python
single_emission_matrix=np.array([single_emission_score[key]for key in single_emission_score.keys()])
```


```python
single_emission_matrix
```




    array([[ 350.,  525.,  105., ...,    0.,    0.,    0.],
           [   0.,  105.,  315., ...,    0.,    0.,    0.],
           [   0.,   30.,    0., ...,    0.,    0.,    0.],
           ..., 
           [   0.,    0.,    0., ...,    0.,    0.,    0.],
           [   0.,    0.,    0., ...,    0.,    0.,    0.],
           [   0.,    0.,    0., ...,    0.,    0.,    0.]])




```python
for i in range(len(single_emission_matrix)):
    
    emission_item=single_emission_matrix[i]
    
    sum = 0
    
    for item in emission_item:
        
        sum += item
    
    for j in range(len(emission_item)):
        
        emission_item[j] /= float(sum)
```


```python
single_model=hmm.MultinomialHMM(n_components=len(coor_divide))
```


```python
single_startprob=np.array([1.0/len(coor_divide)]*len(coor_divide))
```


```python
single_model.startprob_=single_startprob
```


```python
len(coor_divide)
```




    2578




```python
len(single_transition_matrix)
```




    2578




```python
single_model.transmat_=single_transition_matrix
```


```python
single_model.emissionprob_=single_emission_matrix
```


```python
single_model.n_features=len(single_observation_symbol)
```


```python
single_test_label=[]

single_test_sequence=[]

for i in range(len(test4G.Grid_ID)):
    
    lon = round(test4G.Longitude[i],4)
    
    lat = round(test4G.Latitude[i],4)
    
    if [lon,lat] not in states_list:
        
        continue
    
    elif [test4G.SRNCID[i],test4G.BestCellID[i]] not in base_station_list:
        continue
    else:
        
        index = base_station_list.index([test4G.SRNCID[i],test4G.BestCellID[i]])
        
        rssi = test4G.EcNo_1[i] - test4G.RSCP_1[i]
        
        single_test_sequence.append([index,rssi])
        
        coor_index = states_list.index([lon,lat])
        
        single_test_label.append(coor_index)
```


```python
len(single_test_sequence)
```




    7170




```python
len(final_test_sequence)
```




    7558




```python
single_result_label = single_model.predict(final_test_sequence)
```


```python
single_test_sequence[0]

```




    [60, 76.620000000000005]




```python
single_rssi_list=[]

for item in single_test_sequence:
    
    single_rssi_list.append(item[1])
```


```python
min(single_rssi_list)
```




    40.0




```python
max(single_rssi_list)
```




    979.75




```python
min_test_rssi=min(single_rssi_list)
max_test_rssi=single_rssi_list[int(len(single_rssi_list)*0.8)]

for i in range(len(single_rssi_list)):
    
    rssi = single_test_sequence[i][1]
    
    rssi_new = round( ((rssi - min_test_rssi) / (max_test_rssi - min_test_rssi) * 31) )
    
    if rssi_new < 0:
        rssi_new = 0
        
    if rssi_new>31:
        
        rssi_new = 31
    
    single_test_sequence[i][1]=rssi_new

```


```python
len(single_test_sequence)
```




    7170




```python
len(single_test_label)
```




    7170




```python
final_single_test_sequence=[]
final_single_test_label=[]
for i in range(len(single_test_sequence)):
    
    if single_test_sequence[i] not in single_observation_symbol:
        continue
    else:
        
        index = single_observation_symbol.index(single_test_sequence[i])
        
        final_single_test_sequence.append([index])
        
        final_single_test_label.append(single_test_label[i])
```


```python
single_test_result=single_model.predict(final_single_test_sequence)
```


```python
count = 0
for pre,tru in zip(single_test_result,single_test_label):
    
    if pre == tru :
        
        count += 1
print count
```

    7
    


```python
single_test_result
```




    array([ 935,  935,  935, ...,  768, 1524, 1524])




```python
states_list[935]
```




    [121.4998, 31.2162]




```python
single_test_label[0]
```




    1637




```python
states_list[1637]
```




    [121.502, 31.217]




```python
distance_error= 0
for pre,tru in zip(single_test_result,single_test_label):
    
    pre_coor=states_list[pre]
    
    tru_coor=states_list[tru]
    
    distance_error += distance_sphere(pre_coor[1],pre_coor[0],tru_coor[1],tru_coor[0])
    
print distance_error / len(single_test_result)
```

    743.768133197
    


```python

```
